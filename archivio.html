<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Archivio Spese</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Archivio Spese</h1>
    <nav>
      <a href="index.html">Dashboard</a>
      <a href="aggiungi.html">Aggiungi</a>
      <a href="archivio.html" class="nav-active">Archivio</a>
      <a href="impostazioni.html">Impostazioni</a>
    </nav>
  </header>

  <main>
    <section>
      <h2>Tutte le Spese</h2>
      <div id="expenseList"></div>
    </section>
  </main>

  <script>
    class ExpenseTracker {
      constructor() {
        this.expenses = JSON.parse(localStorage.getItem('expenses')) || [];
        this.supermarkets = JSON.parse(localStorage.getItem('supermarkets')) || [
          "Esselunga", "Coop", "Carrefour"
        ];
      }

      getSupermarketName(name) {
        // Controlla se il supermercato esiste nella lista aggiornata
        return this.supermarkets.includes(name) ? name : "(Supermercato rimosso)";
      }

      renderExpenses() {
        const expenseList = document.getElementById('expenseList');
        expenseList.innerHTML = '';

        if (this.expenses.length === 0) {
          expenseList.innerHTML = '<p>Nessuna spesa registrata.</p>';
          return;
        }

        this.expenses.forEach(exp => {
          const div = document.createElement('div');
          div.className = 'recent-item';
          div.innerHTML = `
            <div class="recent-info">
              <strong>${exp.description}</strong><br>
              <small>${new Date(exp.date).toLocaleDateString('it-IT')} - ${this.getSupermarketName(exp.store)}</small>
            </div>
            <div class="recent-amount">â‚¬${exp.amount.toFixed(2)}</div>
          `;
          expenseList.appendChild(div);
        });
      }
    }

    const tracker = new ExpenseTracker();
    tracker.renderExpenses();
  </script>
</body>
</html>